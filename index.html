<!DOCTYPE html>
<html>
    <head>
        <title>Project Beta</title>
        <link rel="icon" type="image/png" href="favicon.png">
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
        <div class="container">
        <h1>=== Project BÃ¨ta ===</h1>
        <p>
        <input type="number" id="van_num" value="0"> 
        <select id="van_eh" onchange="van_eh_update()">
            <option value="time">s</option>
            <option value="distance">m</option>
            <option value="speed">m/s</option>
            <option value="acceleration">m/s^2</option>
        </select> 
        =
        <span id="result"</span>
        </p>
        <p>
        <select id="dist_eh"></select>
        <select id="time_eh"></select>
        <button type="button" id="chosen">gekozen</button>
        <button type="button" id="best">beste</button>
        <button type="button" id="random">random</button>
        </p>
        <p>Je kunt wetenschappelijke notatie gebruiken met e; bv: 123e-12.</p>
        <p>
            Gemaakt door het <b>cansat team I. Explorers</b>. Onze social media:
            <a href="https://myspace.com/i_explorer">myspace</a>,
            <a href="https://www.instagram.com/i_explorer2025">instagram</a>,
            ...
        </p>
        </div>
    </body>
    <script>
        const time_formats = [
            "plancktijd",
            "cesium-133 oscillaties",
            "svedberg",
            "shake",
            "seconden",
            "min",
            "moment",
            "kwartier",
            "uur",
            "dag",
            "weekend",
            "verlengd weekend",
            "brug weekend",
            "quarantaine",
            "trimester",
            "jaar",
            "schrikkeljaar",
            "olympiade",
        ];

        const distance_formats = [
            "plancklengte",
            "angstrom",
            "centimeter",
            "el",
            "voet",
            "meter",
            "inch",
            "zeemijl",
            "AE",
            "parsec",
            "lichtcesium-133 oscillaties",
            "lichtsvedberg",
            "lichtshake",
            "lichtseconden",
            "lichtmin",
            "lichtmoment",
            "lichtkwartier",
            "lichtuur",
            "lichtdag",
            "lichtweekend",
            "lichtverlengd weekend",
            "brug weekend",
            "lichtquarantaine",
            "lichttrimester",
            "lichtjaar",
            "lichtschrikkeljaar",
            "lichtolympiade"
        ];

        function convert_seconds(t, to) {
            switch (to) {
                case "plancktijd": return t * 10**44 / 5.39124;
                case "cesium-133 oscillaties": return t * 9192631770;
                case "svedberg": return t * 10**-13;
                case "shake": return t * 10**-8;
                case "seconden": return t;
                case "min": return t / 60;
                case "moment": return t / 90;
                case "kwartier": return t / 900;
                case "uur": return t / 3600;
                case "dag": return t / 86400;
                case "weekend": return t / 172800;
                case "verlengd weekend": return t / 259200;
                case "brug weekend": return t / 345600;
                case "quarantaine": return t / 3456000;
                case "trimester": return t / 2880000;
                case "jaar": return t / 31536000;
                case "schrikkeljaar": return t / 31622400;
                case "olympiade": return t / 126144000;
                default: return null;
            }
        }

        function convert_meters(x, to) {
            switch (to) {
                case "plancklengte": return x * 10**35 / 1.616255;
                case "angstrom": return x * 1000000000;
                case "centimeter": return x * 100;
                case "el": return x * 0.692;
                case "voet": return x * 0.3048;
                case "meter": return x;
                case "inch": return x / 0.0254;
                case "zeemijl": return x / 1852;
                case "AE": return x / 149597870700;
                case "parsec": return x / (149597870700 * 648000 / Math.PI);
                default: {
                    if (to.startsWith("licht")) {
                        const r = convert_seconds(1, to.slice(5));
                        return (x * r) / 299792458;
                    } else {
                        return null;
                    }
                }
            }
        }

        function convert_speed(v, dist, time) {
            const d = convert_meters(1, dist);
            const t = convert_seconds(1, time);
            return v * d / t;
        }

        function convert_acceleration(a, dist, time) {
            const d = convert_meters(1, dist);
            const t = convert_seconds(1, time);
            return a * d / t**2;
        }

        function random_element(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function update_result(res, eh) {
            document.getElementById("result").textContent = res.toString().replace("e", " * 10^") + " " + eh;
        }

        // fuck js
        function to_non_exponential(num) {
            const str = num.toString();
            if (str.indexOf('e') === -1) return str;
            const [base, exp] = str.split('e');
            const expNum = Number(exp);

            if (expNum > 0) {
                const [intPart, decPart=''] = base.split('.');
                return intPart + (decPart + '0'.repeat(expNum)).slice(0, expNum) + (decPart.length > expNum ? '.' + decPart.slice(expNum) : '');
            } else {
                const zeros = '0'.repeat(Math.abs(expNum) - 1);
                return '0.' + zeros + base.replace('.', '');
            }
        }

        function calc_score(num) {
            const leading_0_pennalty = 2;
            const snum = to_non_exponential(num);
            const [front, back = ""] = snum.split(".");
            if (front == "0") {
                const m = back.match(/^0+/);
                return (m ? m[0].length : 0) + leading_0_pennalty;
            }
            return front.length;
        }

        function best_result_1(v, formats, convert) {
            let best_score = Number.MAX_SAFE_INTEGER;
            let best_format = "";
            let best_result = 0;

            for (let i = 0; i < formats.length; i++) {
                const f = formats[i];
                const res = convert(v, f);
                const score = calc_score(res);
                if (score < best_score || (score == best_score && res < best_result)) {
                    best_score = score;
                    best_format = f;
                    best_result = res;
                }
            }

            return [best_result, best_format];
        }

        function best_result_2(v, d_fmt, t_fmt, convert, acc) {
            let best_score = Number.MAX_SAFE_INTEGER;
            let best_format = "";
            let best_result = 0;

            for (let i = 0; i < d_fmt.length; i++) {
                for (let j = 0; j < t_fmt.length; j++) {
                    const d = d_fmt[i];
                    const t = t_fmt[j];
                    const res = convert(v, d, t);
                    const score = calc_score(res);
                    if (score < best_score || (score == best_score && res < best_result)) {
                        best_score = score;
                        best_format = d + "/" + t;
                        if (acc) { best_format += "^2" }
                        best_result = res;
                    }
                }
            }

            return [best_result, best_format];
        }

        function find_best(v, mode) {
            switch (mode) {
                case "time": return best_result_1(v, time_formats, convert_seconds);
                case "distance": return best_result_1(v, distance_formats, convert_meters);
                case "speed": return best_result_2(v, distance_formats, time_formats, convert_speed, false);
                case "acceleration": return best_result_2(v, distance_formats, time_formats, convert_acceleration, true);
                default: return null;
            }
        }

        function set_eh(t_eh, d_eh) {
            const van_num = document.getElementById('van_num').value;
            const van_eh = document.getElementById('van_eh').value;

            switch (van_eh) {
                case "time": {
                    const result = convert_seconds(van_num, t_eh);
                    update_result(result, t_eh);
                    break;
                }
                case "distance": {
                    const result = convert_meters(van_num, d_eh);
                    update_result(result, d_eh);
                    break;
                }
                case "speed": {
                    const result = convert_speed(van_num, d_eh, t_eh);
                    update_result(result, d_eh + "/" + t_eh);
                    break;
                }
                case "acceleration": {
                    const result = convert_acceleration(van_num, d_eh, t_eh);
                    update_result(result, d_eh + "/" + t_eh + "^2");
                    break;
                }
            }
        }

        function set_random() {
            const rand_t_eh = random_element(time_formats);
            const rand_d_eh = random_element(distance_formats);
            set_eh(rand_t_eh, rand_d_eh);
        }

        function set_chosen() {
            const t_eh = document.getElementById('time_eh').value;
            const d_eh = document.getElementById('dist_eh').value;
            set_eh(t_eh, d_eh);
        }

        function set_best() {
            const van_num = document.getElementById('van_num').value;
            const van_eh = document.getElementById('van_eh').value;
            const res = find_best(van_num, van_eh);
            update_result(res[0], res[1]);
        }

        function set_selection(selection, options) {
            const select = document.getElementById(selection);
            for (let i = 0; i < options.length; i++) {
                const option = document.createElement("option");
                const form = options[i];
                option.value = form;
                option.text = form;
                select.appendChild(option);
            }
        }

        function van_eh_update() {
            const van_eh = document.getElementById("van_eh").value;
            const t_eh = document.getElementById('time_eh');
            const d_eh = document.getElementById('dist_eh');
            switch (van_eh) {
                case "time": {
                    t_eh.disabled = false;
                    d_eh.disabled = true;
                    break;
                }
                case "distance": {
                    t_eh.disabled = true;
                    d_eh.disabled = false;
                    break;
                }
                case "speed": {
                    t_eh.disabled = false;
                    d_eh.disabled = false;
                    break;
                }
                case "acceleration": {
                    t_eh.disabled = false;
                    d_eh.disabled = false;
                    break;
                }
            }
        }

        function run() {
            set_selection("time_eh", time_formats);
            set_selection("dist_eh", distance_formats);
            document.getElementById("random").onclick = set_random;
            document.getElementById("best").onclick = set_best;
            document.getElementById("chosen").onclick = set_chosen;
            van_eh_update();
            set_best();
        }

        run();
    </script>
    <style>
        body {
            background-color: #c0c0c0;
            font-family: "Times New Roman", serif;
            color: #002000;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #ff0000;
            text-align: center;
            text-shadow: 1px 1px #631214;
        }

        a {
            color: #0000ff;
            text-decoration: underline;
        }

        a:hover {
            color: #ff0000;
            background-color: #ffff00;
        }

        .container {
            border: 2px ridge #009900;
            background-color: #ffffff;
            padding: 10px;
            width: 80%;
            margin: 0 auto;
        }

        button {
            background-color: #c0c0c0;
            border: 2px outset #ffffff;
            padding: 5px 10px;
            font-family: "Courier New", monospace;
        }

        button:hover {
            background-color: #848484;
        }
    </style>
</html>
